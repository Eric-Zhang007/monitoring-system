# Copy this file to ".env" and replace all placeholder values before production use.
# Do not commit real secrets.

# Core runtime
DATABASE_URL=postgresql://monitor:REPLACE_WITH_STRONG_DB_PASSWORD@localhost:5432/monitor
REDIS_URL=redis://127.0.0.1:6379
# Optional: force runtime scripts to use a specific interpreter (default prefers .venv/bin/python)
PYTHON_BIN=

# Backend CORS (explicit allowlist, comma-separated)
CORS_ALLOW_ORIGINS=http://localhost:3001,http://127.0.0.1:3001
CORS_ALLOW_CREDENTIALS=1

# Backtest alignment hard gate in production
BACKTEST_STRICT_ASOF_HARD_FAIL=1

# Inference data-source policy
INFER_PRICE_FALLBACK_ENABLED=0

# Server preflight compatibility
REQUIRE_SCREEN=1

# Grafana
GF_SECURITY_ADMIN_PASSWORD=REPLACE_WITH_STRONG_GRAFANA_PASSWORD

# Optional live trading credentials (leave empty if not used)
BITGET_API_KEY=
BITGET_API_SECRET=
BITGET_API_PASSPHRASE=

# Collector multilingual + social source controls
ENABLE_SOCIAL_CONNECTORS=1
SOCIAL_CONNECTORS=twitter,reddit,youtube,telegram
TWITTER_QUERY=(bitcoin OR ethereum OR solana OR 比特币 OR 以太坊 OR 索拉纳 OR $BTC OR $ETH OR $SOL) -is:retweet
YOUTUBE_QUERY=crypto bitcoin ethereum solana 比特币 以太坊 索拉纳
RSS_EXTRA_FEEDS=
COMMENT_RATIO_TARGET=10.0
ENFORCE_COMMENT_RATIO=1
SOCIAL_REQUEST_JITTER_MIN_SEC=0.2
SOCIAL_REQUEST_JITTER_MAX_SEC=1.2
SOCIAL_CONNECTOR_COOLDOWN_SEC=0.8
REDDIT_COMMENTS_PER_POST=120
REDDIT_MAX_POSTS_FOR_COMMENTS=500
REDDIT_FETCH_COMMENTS=1
REDDIT_USER_AGENT_POOL=monitoring-system/2.0;;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 Chrome/124.0.0.0 Safari/537.36

# Continuous paper + retrain loop
ENABLE_CONTINUOUS_OPS_LOOP=1
OPS_INTERVAL_SEC=900
OPS_STATE_FILE=artifacts/ops/continuous_runtime_state.json
OPS_HISTORY_FILE=artifacts/ops/continuous_runtime_history.jsonl
OPS_PAPER_AFTER_FIRST_TRAIN=1
OPS_RUN_FINETUNE_ON_GATE_FAIL=1
OPS_PROFIT_GATE_CMD=python3 scripts/gate_training_profitability.py --track liquid --lookback-hours 168
OPS_FINETUNE_CMD=python3 scripts/optuna_liquid_hpo.py --compute-tier local --n-trials 20

# Training profitability gate
PROFIT_GATE_LOOKBACK_HOURS=168
PROFIT_GATE_LIMIT=32
PROFIT_GATE_SCORE_SOURCE=model
PROFIT_GATE_DATA_REGIME=prod_live
PROFIT_GATE_MIN_COMPLETED_RUNS=4
PROFIT_GATE_MIN_MEAN_PNL_AFTER_COST=0.0
PROFIT_GATE_MIN_MEAN_SHARPE_DAILY=0.2
PROFIT_GATE_MAX_WORST_DRAWDOWN=0.35
PROFIT_GATE_MIN_MEAN_HIT_RATE=0.48
PROFIT_GATE_SNAPSHOT=artifacts/ops/training_profitability_gate.json

# Dual-GPU hard requirements (server, A100 NVLINK)
REQUIRE_A100X2=0
REQUIRE_NVLINK=0
SKIP_GPU_CHECK=0

# LLM enrichment (OpenAI-compatible chat completion API)
LLM_ENRICHMENT_ENABLED=1
LLM_API_KEY=
LLM_API_BASE_URL=https://api.openai.com/v1
LLM_CHAT_COMPLETIONS_PATH=/chat/completions
LLM_MODEL=gpt-4o-mini
LLM_TIMEOUT_SEC=20
LLM_MAX_RETRIES=3
LLM_BACKOFF_SEC=1.0
LLM_MAX_INPUT_CHARS=4000
LLM_MAX_SUMMARY_CHARS=320
LLM_MAX_TOKENS=350
LLM_ENRICH_MAX_EVENTS=0

# Phase-D multimodal experiment bundle (server-run ready)
PHASE_D_START=2018-01-01T00:00:00Z
PHASE_D_END=
PHASE_D_SYMBOLS=BTC,ETH,SOL
PHASE_D_HORIZON_STEPS=1
PHASE_D_RUN_TRAIN=1
PHASE_D_RUN_BACKBONE=1
PHASE_D_RUN_ABLATION=1
PHASE_D_RUN_REGISTER=1

BACKBONE_EXP_BACKBONES=ridge,itransformer,patchtst,tft
BACKBONE_EXP_LOOKBACK_STEPS=32
BACKBONE_EXP_MAX_SAMPLES=30000
BACKBONE_EXP_EPOCHS=6
BACKBONE_EXP_BATCH_SIZE=256
BACKBONE_EXP_LR=0.001

MULTIMODAL_L2=0.05
MULTIMODAL_ABLATIONS=full,no_text,no_macro,event_window
MULTIMODAL_EVENT_WINDOW_THRESHOLD=0.05

# Candidate registration gate (optional; set CANDIDATE_ENFORCE_GATES=1 to hard-block)
CANDIDATE_ENFORCE_GATES=0
CANDIDATE_MIN_OOS_HIT_RATE=0.50
CANDIDATE_MAX_OOS_MSE=1.0
CANDIDATE_MIN_BACKBONE_READY=0
CANDIDATE_REQUIRED_BACKBONES=
CANDIDATE_MAX_DELTA_MSE_NO_TEXT_VS_FULL=1.0
CANDIDATE_MAX_DELTA_MSE_NO_MACRO_VS_FULL=1.0

# ModelOps multimodal gate (scheduler side)
MULTIMODAL_GATE_ENABLE=1
MULTIMODAL_GATE_REQUIRE_PASSED=1
MULTIMODAL_GATE_MIN_READY_BACKBONES=0
MULTIMODAL_GATE_REQUIRED_BACKBONES=
MULTIMODAL_GATE_MIN_TEXT_COVERAGE=0.0
MULTIMODAL_GATE_MAX_DELTA_MSE_NO_TEXT=1.0
MULTIMODAL_GATE_MAX_DELTA_MSE_NO_MACRO=1.0
MULTIMODAL_GATE_STRICT_BLOCK=0
MULTIMODAL_GATE_SNAPSHOT=artifacts/ops/multimodal_gate_state.json

# Optional strict gate for scripts/validate_no_leakage.py
VALIDATE_REQUIRE_CANDIDATE_GATE_PASSED=0
VALIDATE_CANDIDATE_MAX_AGE_HOURS=0
VALIDATE_REQUIRE_MULTIMODAL_GATE_PASSED=0
VALIDATE_MULTIMODAL_GATE_MAX_AGE_HOURS=0

# Data-gap remediation bundle (server-run ready)
START_TS=2018-01-01T00:00:00Z
END_TS=
TIMEFRAME=5m
SYMBOLS=BTC,ETH,SOL,BNB,XRP,ADA,DOGE,TRX,AVAX,LINK
RUN_MARKET=1
RUN_AUX=1
RUN_DERIVATIVES=1
RUN_ORDERBOOK_PROXY=1
RUN_SOCIAL=1
RUN_FINAL_AUDIT=1
SOCIAL_STRICT=0
INGEST_CHUNK_DAYS=30
INGEST_WORKERS=3
INGEST_MAX_CHUNKS=0
MARKET_FALLBACK_SOURCE=none
BINANCE_OI_MAX_LOOKBACK_DAYS=30
BINANCE_DERIV_MAX_LOOKBACK_DAYS=30

# Offline bundle build (local collection -> upload/import server)
RUN_MARKET_SECONDARY=0
RUN_EVENTS=1
RUN_AUDIT=1
RUN_EXPORT=1
RUN_PACKAGE=1
SECONDARY_TF=1h
EVENT_CHUNK_DAYS=30
EVENT_MAX_CHUNKS=0
EVENT_SOCIAL_SOURCES=twitter,reddit,youtube,telegram
EVENT_DISABLE_GOOGLE=0
EVENT_DISABLE_GDELT=0
EVENT_DISABLE_OFFICIAL_RSS=0
EVENT_DISABLE_SOURCE_BALANCE=0
EVENT_GDELT_MAX_RECORDS=50
EVENT_DAY_STEP=7
OUT_ROOT=artifacts/offline_bundle
STRICT_ASOF_AFTER_IMPORT=0

# Optional overrides for orchestrated event backfill (used by scripts/orchestrate_event_social_backfill.py)
BACKFILL_EVENT_DISABLE_GOOGLE=0
BACKFILL_EVENT_DISABLE_GDELT=0
BACKFILL_EVENT_DISABLE_OFFICIAL_RSS=0
BACKFILL_EVENT_DISABLE_SOURCE_BALANCE=0
BACKFILL_EVENT_GDELT_MAX_RECORDS=50
BACKFILL_EVENT_DAY_STEP=7

# Required-data collection orchestrator (local full collection -> readiness audit -> offline bundle)
RUN_PRE_AUDIT=1
RUN_PRIMARY_REMEDIATION=1
RUN_SECONDARY_MARKET=1
RUN_ORCHESTRATED_EVENTS=1
RUN_POST_AUDIT=1
RUN_BUILD_OFFLINE_BUNDLE=1
BUNDLE_OUT_ROOT=artifacts/offline_bundle

# Synthetic orderbook proxy tuning
OB_PROXY_MIN_SPREAD_BPS=1.5
OB_PROXY_MAX_SPREAD_BPS=35.0
OB_PROXY_SPREAD_RET_K=2800.0
OB_PROXY_SPREAD_DEPTH_K=8.0
OB_PROXY_BASE_SIZE_DIV=20.0
OB_PROXY_MIN_BASE_SIZE=1.0
OB_PROXY_IMBALANCE_K=2.0
